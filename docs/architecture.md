# EduChat ì•„í‚¤í…ì²˜ ìƒì„¸ ë¬¸ì„œ

## ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ê°œìš”

### MVVM íŒ¨í„´ ê¸°ë°˜ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ChatView      â”‚    â”‚  ChatManager    â”‚    â”‚ OpenAIService   â”‚
â”‚   (View)        â”‚â—„â”€â”€â–ºâ”‚  (ViewModel)    â”‚â—„â”€â”€â–ºâ”‚   (Service)     â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â€¢ UI í‘œì‹œ       â”‚    â”‚ â€¢ ìƒíƒœ ê´€ë¦¬     â”‚    â”‚ â€¢ API í†µì‹       â”‚
â”‚ â€¢ ì‚¬ìš©ì ì…ë ¥   â”‚    â”‚ â€¢ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ â”‚    â”‚ â€¢ ì‘ë‹µ ì²˜ë¦¬     â”‚
â”‚ â€¢ ì´ë²¤íŠ¸ ì²˜ë¦¬   â”‚    â”‚ â€¢ ë°ì´í„° ë³€í™˜   â”‚    â”‚ â€¢ ì—ëŸ¬ ì²˜ë¦¬     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â–²                       â–²                       â–²
         â”‚                       â”‚                       â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   UserDefaults  â”‚
                    â”‚  (Persistence)  â”‚
                    â”‚                 â”‚
                    â”‚ â€¢ API í‚¤ ì €ì¥   â”‚
                    â”‚ â€¢ ì„¤ì • ì €ì¥     â”‚
                    â”‚ â€¢ ëŒ€í™” ê¸°ë¡     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ ë°ì´í„° í”Œë¡œìš°

### 1. ì‚¬ìš©ì ì…ë ¥ â†’ AI ì‘ë‹µ

```mermaid
sequenceDiagram
    participant U as User
    participant V as ChatView
    participant VM as ChatManager
    participant S as OpenAIService
    participant A as OpenAI API

    U->>V: ë©”ì‹œì§€ ì…ë ¥
    V->>VM: sendMessage()
    VM->>VM: ë©”ì‹œì§€ ê²€ì¦
    VM->>S: generateReply()
    S->>A: HTTP ìš”ì²­
    A-->>S: JSON ì‘ë‹µ
    S-->>VM: ì²˜ë¦¬ëœ ì‘ë‹µ
    VM-->>V: UI ì—…ë°ì´íŠ¸
    V-->>U: ì‘ë‹µ í‘œì‹œ
```

### 2. ëª¨ë“œ ì „í™˜ í”Œë¡œìš°

```mermaid
stateDiagram-v2
    [*] --> ì¼ë°˜ëª¨ë“œ
    ì¼ë°˜ëª¨ë“œ --> ë”¥ëŸ¬ë‹ëª¨ë“œ: í† ê¸€ ON
    ë”¥ëŸ¬ë‹ëª¨ë“œ --> ì¼ë°˜ëª¨ë“œ: í† ê¸€ OFF

    ì¼ë°˜ëª¨ë“œ --> ì¼ë°˜ëª¨ë“œ: ì¹œê·¼í•œ ì‘ë‹µ
    ë”¥ëŸ¬ë‹ëª¨ë“œ --> ë”¥ëŸ¬ë‹ëª¨ë“œ: ì‚¬ì „ ì§ˆë¬¸ â†’ ì‹¬ì¸µ ë¶„ì„
```

### 3. ë”¥ëŸ¬ë‹ ëª¨ë“œ ì‚¬ì „ ì§ˆë¬¸ í”Œë¡œìš°

```mermaid
flowchart TD
    A[ì‚¬ìš©ì ì§ˆë¬¸] --> B[ë”¥ëŸ¬ë‹ ëª¨ë“œ í† ê¸€ ON]
    B --> C[ìƒˆ ì„¸ì…˜ ìƒì„±]
    C --> D[ì›°ì»´ ë©”ì‹œì§€ í‘œì‹œ]
    D --> E[1ë‹¨ê³„: ë¶„ì„ ê³„íš ìˆ˜ë¦½]
    E --> F[ì‚¬ìš©ì ê³„íš ë‹µë³€]
    F --> G[2ë‹¨ê³„: ì‘ë‹µ êµ¬ì„± ë°©ì‹]
    G --> H[ì‚¬ìš©ì êµ¬ì„± ë‹µë³€]
    H --> I[ìµœì¢… ì‹¬ì¸µ ë¶„ì„ ìƒì„±]
```

## ğŸ“Š ëª¨ë“œë³„ ì‘ë‹µ êµ¬ì¡°

### ì¼ë°˜ëª¨ë“œ ì‘ë‹µ êµ¬ì¡°
```
ğŸ“– ì •ì˜ (ê¸°ì´ˆ ì›ë¦¬ í¬í•¨)
   â”œâ”€â”€ ê¸°ë³¸ ê°œë… ì„¤ëª…
   â”œâ”€â”€ ê°„ë‹¨í•œ ì›ë¦¬ ì„¤ëª…
   â””â”€â”€ ì‹¤ìš©ì  ë§¥ë½

ğŸ’¡ ì˜ˆì‹œ (ì‹¤ì œ ì ìš© ì‚¬ë¡€)
   â”œâ”€â”€ êµ¬ì²´ì ì¸ ì‚¬ìš© ì‚¬ë¡€
   â”œâ”€â”€ ê²°ê³¼ ì„¤ëª…
   â””â”€â”€ ì‹¤ì§ˆì  íš¨ê³¼

ğŸ”„ ì°¨ì´ì  (ê¸°ë³¸ì  ë¹„êµ)
   â”œâ”€â”€ ìœ ì‚¬ ê°œë…ê³¼ì˜ ì°¨ì´
   â”œâ”€â”€ ì¥ë‹¨ì  ë¹„êµ
   â””â”€â”€ ì„ íƒ ê¸°ì¤€

ğŸš€ íŒ (ì¶”ê°€ í•™ìŠµ ì œì•ˆ)
   â”œâ”€â”€ ì‹¤ì²œ ë°©ë²•
   â”œâ”€â”€ í•™ìŠµ ë°©í–¥
   â””â”€â”€ ë‹¤ìŒ ë‹¨ê³„
```

### ë”¥ëŸ¬ë‹ ëª¨ë“œ ì‘ë‹µ êµ¬ì¡°
```
ğŸ§  ê°œë…ì˜ í•µì‹¬ ë³¸ì§ˆ íŒŒì•…
   â”œâ”€â”€ ë¹„ìœ ë¥¼ í†µí•œ ì§ê´€ì  ì„¤ëª…
   â”œâ”€â”€ ê¸°ë³¸ ê°œë… ì •ì˜
   â””â”€â”€ í•µì‹¬ ì›ë¦¬ ì†Œê°œ

ğŸ” í‘œë©´ê³¼ ê´€ê³„ì„± ë¶„ì„
   â”œâ”€â”€ ê¸°ì´ˆ ê°œë… ì´í•´
   â”œâ”€â”€ ìœ ì‚¬ ê°œë…ê³¼ì˜ ê´€ê³„
   â””â”€â”€ ìƒëŒ€ì  ìœ„ì¹˜ íŒŒì•…

âš™ï¸ ì›ë¦¬ì™€ êµ¬í˜„ ë°©ë²•
   â”œâ”€â”€ ì´ë¡ ì  ê¸°ë°˜ ì„¤ëª…
   â”œâ”€â”€ ì‹¤ì œ ì ìš© ê¸°ìˆ 
   â””â”€â”€ êµ¬í˜„ ì „ëµ

ğŸŒ ì‘ìš©ê³¼ í™œìš© ë¶„ì•¼
   â”œâ”€â”€ ë‹¤ì–‘í•œ ë¶„ì•¼ ì ìš©
   â”œâ”€â”€ ì‹¤ë¬´ ì‚¬ë¡€
   â””â”€â”€ í™•ì¥ ê°€ëŠ¥ì„±

ğŸ“š ì—­ì‚¬ì  ë°œì „ê³¼ ë§¥ë½
   â”œâ”€â”€ ë°œì „ ê³¼ì •
   â”œâ”€â”€ ì§„í™” ì—­ì‚¬
   â””â”€â”€ í˜„ì¬ ì˜ë¯¸

âš–ï¸ í•œê³„ì™€ ë¯¸ë˜ ì „ë§
   â”œâ”€â”€ ì œì•½ì‚¬í•­ ë¶„ì„
   â”œâ”€â”€ ê°œì„  ë°©í–¥
   â””â”€â”€ ë¯¸ë˜ ë°œì „
```

## ğŸ¯ êµìœ¡ ëª©í‘œ ë‹¬ì„± ë©”ì»¤ë‹ˆì¦˜

### ë¹„ê³ ì¸ í‚¤ êµìœ¡ ëª©í‘œ ì‹¤í˜„

```mermaid
mindmap
  root((ë¹„ê³ ì¸ í‚¤ ëª©í‘œ))
    ë¹„êµ ëŠ¥ë ¥
      ì›ë¦¬ ì´í•´
        ìì—°ì  ë¹„êµ
          ììœ¨ì  íŒë‹¨
    í‰ê°€ ëŠ¥ë ¥
      ì‹¬ì¸µ ë¶„ì„
        ì²´ê³„ì  í‰ê°€
          ë©”íŠ¸ë¦­ í™œìš©
    ììœ¨ í•™ìŠµ
      ê·¼ë³¸ì  ì‚¬ê³ 
        í‰ìƒ í•™ìŠµ
          ì§€ì†ì  ì„±ì¥
```

## ğŸ”§ ê¸°ìˆ ì  êµ¬í˜„ ì„¸ë¶€ì‚¬í•­

### ìƒíƒœ ê´€ë¦¬
```swift
class ChatManager: ObservableObject {
    @Published var messages: [Message] = []
    @Published var isLoading: Bool = false
    @Published var errorMessage: String?
    @Published var fullStudyMode: Bool = false
}
```

### AI ì„œë¹„ìŠ¤ ê³„ì¸µ
```swift
class OpenAIService {
    private let defaultModel = "gpt-5-nano"

    func generateReply(prompt: String, isStudyMode: Bool = false) async throws -> String {
        let apiKey = getAPIKey()
        guard !apiKey.isEmpty && apiKey.hasPrefix("sk-") else { throw OpenAIError.missingAPIKey }

        let url = URL(string: "https://api.openai.com/v1/chat/completions")!
        var request = URLRequest(url: url)
        request.timeoutInterval = isStudyMode ? 300 : 60
        request.httpMethod = "POST"
        request.setValue("Bearer \(apiKey)", forHTTPHeaderField: "Authorization")
        request.setValue("application/json", forHTTPHeaderField: "Content-Type")

        // ë”¥ëŸ¬ë‹ ëª¨ë“œìš© ìƒì„¸ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸ ì ìš©
        let messages = createMessagesForMode(prompt, isStudyMode)
        let body = ["model": defaultModel, "messages": messages] as [String : Any]
        request.httpBody = try JSONSerialization.data(withJSONObject: body, options: [])

        let (data, _) = try await URLSession.shared.data(for: request)
        let decoded = try JSONDecoder().decode(OpenAIChatResponse.self, from: data)
        guard let content = decoded.choices.first?.message.content else {
            throw OpenAIError.emptyResponse
        }
        return content
    }
}
```

### UI ì»´í¬ë„ŒíŠ¸ ê³„ì¸µ
```swift
struct ChatView: View {
    @ObservedObject var chatManager: ChatManager

    var body: some View {
        VStack {
            ScrollView { /* ë©”ì‹œì§€ ë¦¬ìŠ¤íŠ¸ */ }
            InputView(chatManager: chatManager)
        }
    }
}
```

## ğŸ“ˆ ì„±ëŠ¥ ìµœì í™”

### ë©”ëª¨ë¦¬ ê´€ë¦¬
- **ë©”ì‹œì§€ ì œí•œ**: ìµœê·¼ 6ê°œ ë©”ì‹œì§€ë§Œ ìœ ì§€
- **ì´ë¯¸ì§€ ìµœì í™”**: í•„ìš”ì‹œ ì§€ì—° ë¡œë”©
- **ìºì‹± ì „ëµ**: ìì£¼ ì‚¬ìš©í•˜ëŠ” ë°ì´í„° ìºì‹œ

### ë„¤íŠ¸ì›Œí¬ ìµœì í™”
- **ìš”ì²­ ë³‘í•©**: ìœ ì‚¬ ìš”ì²­ í†µí•©
- **ì‘ë‹µ ìºì‹±**: ë™ì¼ ì§ˆë¬¸ ìºì‹œ
- **íƒ€ì„ì•„ì›ƒ**: 60ì´ˆ ì œí•œ
- **ì¬ì‹œë„ ë¡œì§**: ë„¤íŠ¸ì›Œí¬ ì‹¤íŒ¨ì‹œ ìë™ ì¬ì‹œë„

### UI ì„±ëŠ¥
- **ì§€ì—° ë Œë”ë§**: ë³´ì´ëŠ” ë©”ì‹œì§€ë§Œ ë Œë”ë§
- **ì• ë‹ˆë©”ì´ì…˜ ìµœì í™”**: 60fps ìœ ì§€
- **ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€**: ìˆœí™˜ ì°¸ì¡° ì œê±°
